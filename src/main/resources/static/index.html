<!DOCTYPE html>
<html>
<head>
    <title>URL Shortener</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        input[type="url"] { width: 70%; padding: 10px; margin-right: 10px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; }
        #result { margin-top: 20px; padding: 10px; background: #e9ecef; border-radius: 4px; }
    </style>
</head>
<body>
<div class="container">
    <h1>URL Shortener</h1>
    <input type="url" id="urlInput" placeholder="Enter your long URL" required>
    <button onclick="shortenUrl()">Shorten</button>
    <div id="result"></div>
</div>

<script>
    async function shortenUrl() {
        const url = document.getElementById('urlInput').value;
        const resultDiv = document.getElementById('result');

        if (!url) {
            resultDiv.innerHTML = '<p style="color: red;">Please enter a URL</p>';
            return;
        }

        try {
            const response = await fetch('/api/shorten', {
                method: 'POST',
                headers: { 'Content-Type': 'text/plain' },
                body: url
            });

            if (response.ok) {
                const data = await response.json();
                const shortUrl = `${window.location.origin}/api/${data.hash}`;
                resultDiv.innerHTML = `
                        <p><strong>Short URL:</strong>
                        <a href="${shortUrl}" target="_blank">${shortUrl}</a></p>
                        <button onclick="copyToClipboard('${shortUrl}')">Copy</button>
                    `;
            } else {
                const error = await response.text();
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error}</p>`;
            }
        } catch (error) {
            resultDiv.innerHTML = `<p style="color: red;">Network error: ${error.message}</p>`;
        }
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            alert('Copied to clipboard!');
        });
    }
</script>
</body>
</html>